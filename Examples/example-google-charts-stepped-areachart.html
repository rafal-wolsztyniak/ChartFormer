<script runat="server">
Platform.Load("Core", "1");

var ChartFormer = eval(Platform.Function.ContentBlockByKey('chartformer-library'));

var de = {
    name: 'Chartformer - Line',
    key: 'AAAAAAAA-2222-CCCC-4444-EEEEEE555555',
    columns: [], // if left empty, the code will get them, if filled, the code will respect the selection and order
    chartInChildBu: true,
    deIsShared: true,
    lookupColumn: 'Chartable',
    lookupValue: true,  
    enterpriseId: 1234
}

var chartData = ChartFormer.google("steppedArea", de);
var chartDataString = Stringify(chartData);



// ‚öôÔ∏è FUNCTIONS ------------------------------------------------------

// üêõ Display Function
function Display(content, color) {
    var displayBlock = '<div style="Background-color:[color];Display: block; margin-bottom: 8px; padding:4px; padding-left:12px; overflow-wrap: break-word;">[text]</div>';

    var defaultConfig = {
        hold: false, // set this to true to disable this function from displaying anything
        randomizeUndefined: true, // should the color be random, if the color is undefined? 
        defaultColor: "whitesmoke", // if the above value is false, use this as the color
        hsl: {
            hueStart: 60, // just to not start at reddish hues reminescent of errors
            saturation: 70, //100 - Math.floor(Math.random()*10),
            lightness: 90, //95 - Math.floor(Math.random()*10)
            increment: 25 // multiply by a number to not get too similar hues, increase to 
        }
    };

    if (defaultConfig.hold != true) {
        // color checks 
        if (typeof color == 'undefined') {
            if (defaultConfig.randomizeUndefined == true){
                color = Math.floor(Math.random()*defaultConfig.hsl.increment);
            } else {
                color = defaultConfig.defaultColor;
            }
        }
        if (typeof color == "number") {
            color = "hsl([h], [s]%, [l]%)"
                        .replace("[h]", (color*defaultConfig.hsl.increment + defaultConfig.hsl.hueStart)%360)
                        .replace("[s]", defaultConfig.hsl.saturation)
                        .replace("[l]", defaultConfig.hsl.lightness)
        } else if ((color == "r") || (color == "random")){
            color = Math.floor(Math.random()*defaultConfig.hsl.increment);
        };

        // Check what was passed as the first argument
        if (typeof content != "string") {
            content = Stringify(content);
        };

        Write(displayBlock
            .replace("[color]", color)
            .replace("[text]", content)
            .replace(/\\/g, "")
            .replace(/,{"/g, ',<br>{<br>"')
            .replace(/\[{"/g, '[<br>{<br>"')
            .replace(/},/g, '<br>},<br>')
            .replace(/,"/g, ',<br>"')
            .replace(/, "/g, ',<br>"')
            .replace(/\[{"/g, '<br>[{')
            );
    }
}
</script>

<html>
  <head>
  <title>Chartformer: Stepped Area Chart </title>
    <style>
        *{
            font-family: monospace;
        },
        .small-font {
            font-size: 10px;
            height: 10px;
            font-family: monospace;
        }
    </style>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);

      var chartData = <ctrl:var name=chartDataString />;
      console.table(chartData);

      function drawChart() {
        var data = google.visualization.arrayToDataTable(.data);

        var options = {
          title: 'Company Performance',
          hAxis: {title: 'Year',  titleTextStyle: {color: '#333'}},
          vAxis: {minValue: 0}
        };

        var chart = new google.visualization.AreaChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 100%; height: 500px;"></div>
  </body>
</html>
</html>


]
<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);

      var chartData = <ctrl:var name=chartDataString />;
      console.table(chartData);
      
      function drawChart() {
        var data = google.visualization.arrayToDataTable(chartData.data);

        var options = {
          title: 'Send Volumes per Channel',
          vAxis: {title: 'Accumulated Rating'},
          isStacked: true
        };

        var chart = new google.visualization.SteppedAreaChart(document.getElementById('chart_div'));

        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html>
